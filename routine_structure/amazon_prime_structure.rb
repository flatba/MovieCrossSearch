# coding: utf-8

require "selenium-webdriver"

require './crawl/selector.rb'
require './crawl/crawl.rb'
require './scrape/scrape.rb'
# require './database/database.rb'
# require './database/save_db_task.rb'

#
# AmazonPrime
#
class AmazonPrimeStructure

 attr_reader :crawl, :scrape

 def initialize
   @crawl  = Crawl.new
   @scrape = Scrape.new
   # @db_task = SaveDBTask.new
 end

 def start(url, site_name)

    @driver        = crawl.initialize_driver
    @selector      = crawl.initialize_selector(site_name)
    @movie_master  = scrape.movie_master
    # @movie_master = @scrape.initialize_movie_master # DB??
    # @db           = @db_task.initialize_data_base(site_name)

    puts "?????????????"
    @driver.get(url)

    # ????????????????????????
    main_doc = crawl.open_url(url)
    category_url_arr = []
    main_doc.css('#nav-subnav > a.nav-a').each do |element|
      # puts a_tag.text.strip   # ??????
      # puts a_tag.attr('href') # ????URL
      category_url_arr << 'https://www.amazon.co.jp' + element.attribute('href')
    end

    # ??????????????
    category_url_arr.each do |category_url|

      # ????????????????category_url????

      # ???????

      # category_url???

        # ???????

        # ????????????

        # ??????????

        # ??????????

    end

 end

end